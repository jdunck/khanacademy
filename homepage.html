{% extends "page_template.html" %}
{% block pagescript %}
<link type="text/css" href="/stylesheets/custom-theme/jquery-ui-1.8.4.custom.css" rel="stylesheet" />
<script src="javascript/jstree/jquery.jstree.js?{{App.version}}"></script>
<style>
    #overview {
        padding: 1ex 1em 1ex 1em;
        display: block;
        float: right;
        min-width: 320px;
        max-width: 640px;
        _width: 640px; /* In case IE6 doesn't understand min-width/max-width */        
    }
    
    #overview #overview_video, #overview embed {
        float: left;
        width: 320px;
        height: 205px;        
    }
    
    #overview #overview_video {
        margin: 1ex;
    }
    
    #overview embed {
        *margin: 1ex; /* Fixes spacing under IE6 and IE7 */ 
    }
    
    #video_library_toc {
        display: inline-block;
        clear: none;
        width: auto;
        padding: 1ex 1em 1ex 1em;
        border: none;
        zoom:1; /* For inline-block in IE7 */
        *display: inline; /* For inline-block in IE7 */
        _height: 1em; /* For inline-block in IE6 */
    }
    #video_library_toc > ul {
        margin-left: 0;
        padding-left: 0;
    }
    #video_library_toc ul {
        margin-left: 0;
        padding-left: 1em;
    }
    #video_library_toc a:link, #video_library_toc a:visited {
        color:#006699;
        text-decoration: underline;
    }
    nav#video_library_toc li:before {
        content: "";
    }
    
    #video_library {
        margin: 1em;
    }
    #video_library section {
        padding-left: 0em;
    }
    #video_library section h1 {
        font-size: larger;
        clear: left;
    }
    #video_library .subtopics {
        border-left: 2px solid #80C65A;
        padding-left: 0em;
        margin-left: 1em;
        clear: left;
    }
    #video_library .subtopics h1 {
        padding-left: 1ex;
    }
    #video_library .subtopics h1 {
        display: block;
        float: left;
        margin-right: auto;
        margin-left: 0;
        padding-bottom: 0;
        margin-bottom: 0;
        border-top: 2px solid #80C65A;
    }
    #video_library .subtopics p, #video_library .subtopics .playlist_container {
        clear: left;
        margin-left: 0;
        padding-left: 1em;
    }
    #video_library .subtopics {
        *padding-top: 1em; /* Reasonable spacing in IE7 */
        *margin-bottom: 1em; /* Reasonable spacing in IE7 */
    }
    #video_library .subtopics .playlist_container {
        *margin-bottom: 1em; /* Reasonable spacing in IE7 */
    }
    #video_library ol li {
        display: inline-block;
        width: 25ex;
        vertical-align: top;
        padding: .5ex 2ex 0ex 0ex;
        border-top: dotted 1px #ccc;
        zoom:1; /* For inline-block in IE7 */
        *display: inline; /* For inline-block in IE7 */
        _height: 1em; /* For inline-block in IE6 */
    }
    
    #video_library ol li a {
        display: block;
        margin-left: 2.5em;
    }
    
    #video_library ol li:before {
        content: counter(video) ". ";
        counter-increment: video;
        text-align: right;
        width: 2em;
        display: block;
        float: left;
    }
    
    #video_library ol {
        counter-reset: video;
        padding: 0ex 0em 0ex 0em;
        display: inline;
        *margin-left: 0; /* Prevents indenting first line in IE7 */
    }
    
    section.not_found {
        display: none !important;
    }    

    li.not_found {
        width: 0 !important;
        padding: 0 !important;
        margin: 0 !important;     
    }

    li.not_found a {
        display: none !important;        
    }

    #video_library ol li.not_found:before {
        content: "" !important;
    }
    
    .search_highlight a {
/*
        background-color: yellow;
*/  
    }
    
    #video_library a.toggler:before {
        content: "+";
    }
    #video_library a.toggler.open:before {
        content: "\2212"; /* minus sign */
    }
    
</style>
<script>
    $(function() {
        $('#video_library_toc')
            .bind('loaded.jstree', function (event, data) {
                data.inst.open_all();

                $('#video_library_toc > ul > li > ul > li').each(function() {
                    data.inst.close_node(this);
                });
                $('#video_library_toc').show();
            })
            .jstree({
                core : {
                    html_titles : true,
                    animation: 0
                },
                themes: {
                    theme: 'classic',
                    icons: false
                },
                plugins: ['html_data', 'themes']
            });

        $('#search_string').keypress(function(e) {
            if (e.which == 13) search();
        });
        $('#search_button').click(search);
        $('#video_library button[type=reset]').click(function() {
            $('#search_string').val('');
            search(); /* Searching for nothing, shows everything. */
        });
        
        function search() {
            var s = $('#search_string').val();
            $('.search_highlight').removeClass('search_highlight');
            // Construct a RegExp that will match strings containing words begininning with
            // the search string (case-insensitive)
            var escapedSearchString = s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
            var re = new RegExp("\\b"+escapedSearchString, "i");
            
            // Hide all the sections and videos initially
            $('#video_library section, #video_library li').addClass('not_found');
            
            // Highlight the videos whose title or keywords match the RegExp, and stop hiding
            // those videos and their containing sections
            $('#video_library li')
                .filter(function() {return re.test($(this).text()) || re.test($(this).attr('data-keywords'));})
                .addClass('search_highlight')
                .parents().andSelf().removeClass('not_found');
                
            // Set the focus to the first matching video
            $('#video_library .search_highlight a').first().focus();
        }
        
        // Force the subtopics divs to go past the floated headings they contain so that
        // the vertical line doesn't disappear when all subtopics are collapsed.
        $("#video_library .subtopics").append("<div style='clear: both;'></div>");
        
        $("#video_library h1").prepend("<a href='#' class='toggler open' title='Collapse/Expand'></a>&nbsp;");
        // Clicking a heading causes the section to collapse/expand.
        $("#video_library .toggler").click(function(e) {
            $(this).parent().siblings().toggle();
            $(this).toggleClass("open");
            e.preventDefault();
        });
    });
</script>
{% endblock pagescript %}
{% block pagetitle %}{% endblock pagetitle %}
{% block pagecontent %}
{% include "homepage_content.html" %}
<script>
$('#video_library_toc').hide();
</script>
{% endblock pagecontent %}